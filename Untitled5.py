#!/usr/bin/env python
# coding: utf-8

# In[2]:


from azure.cognitiveservices.vision.customvision.training import CustomVisionTrainingClient
from azure.cognitiveservices.vision.customvision.training.models import ImageFileCreateEntry, Region


# In[3]:


ENDPOINT = "https://southeastasia.api.cognitive.microsoft.com/"

# Replace with a valid key
training_key = "826bfc3b36e44336a8d99d6a3a7e26e1"
prediction_key = "826bfc3b36e44336a8d99d6a3a7e26e1"
prediction_resource_id = "/subscriptions/b43249d6-d0cd-49c6-8ece-2962cea99c4e/resourceGroups/functionAppp/providers/Microsoft.CognitiveServices/accounts/breadDetection"


publish_iteration_name = "detectModel"

trainer = CustomVisionTrainingClient(training_key, endpoint=ENDPOINT)
# Find the object detection domain
obj_detection_domain = next(domain for domain in trainer.get_domains() if domain.type == "ObjectDetection" and domain.name == "General")

# Create a new project
print ("Creating project...")
project = trainer.create_project("dotandoverflowTest", domain_id=obj_detection_domain.id)


# In[6]:


#dot_tag = trainer.create_tag(project.id, "blackDot")
overflow_tag = trainer.create_tag('bd61cc61-b58a-4011-8da8-85fd909bcd22', "overFlow")


# In[44]:


dot_image_regions = {

'DSC09088.JPG': [0.4266114982578397, 0.796972049689441, 0.01132404181184669, 0.019409937888198756], 
'DSC09089.JPG': [0.7290940766550522, 0.5613354037267081, 0.008493031358885017, 0.019409937888198756], 
'DSC09090.JPG': [0.2624128919860627, 0.5062111801242236, 0.007404181184668989, 0.016692546583850932], 
'DSC09091.JPG': [0.4797473867595819, 0.48020186335403725, 0.01524390243902439, 0.028338509316770188], 
'DSC09092.JPG': [0.49760452961672474, 0.45846273291925466, 0.011977351916376307, 0.026397515527950312], 
'DSC09093.JPG': [0.4653745644599303, 0.4763198757763975, 0.011977351916376307, 0.024844720496894408],
'DSC09094.JPG': [0.48323170731707316, 0.48680124223602483, 0.007621951219512195, 0.019409937888198756],
'DSC09095.JPG': [0.5357142857142857, 0.3843167701863354, 0.009581881533101045, 0.019021739130434784], 
'DSC09096.JPG': [0.4827961672473868, 0.47903726708074534, 0.016986062717770034, 0.028338509316770188],
'DSC09097.JPG': [0.4701655052264808, 0.5023291925465838, 0.013066202090592335, 0.02562111801242236], 
'DSC09098.JPG': [0.2874564459930314, 0.45069875776397517, 0.018945993031358885, 0.033385093167701864], 
'DSC09099.JPG': [0.4958623693379791, 0.5054347826086957, 0.016550522648083623, 0.04231366459627329], 
'DSC09100.JPG': [0.45492160278745647, 0.7232142857142857, 0.01284843205574913, 0.02872670807453416], 
'DSC09101.JPG': [0.29747386759581884, 0.5256211180124224, 0.013719512195121951, 0.019409937888198756],
'DSC09102.JPG': [0.3164198606271777, 0.203027950310559, 0.01088850174216028, 0.017857142857142856],
'DSC09103.JPG': [0.4788763066202091, 0.4635093167701863, 0.01633275261324042, 0.021739130434782608],
'DSC09104.JPG': [0.43314459930313587, 0.12538819875776397, 0.009581881533101045, 0.013975155279503106], 
'DSC09105.JPG': [0.6245644599303136, 0.2294254658385093, 0.013501742160278746, 0.023680124223602484],
'DSC09106.JPG': [0.6548344947735192, 0.39169254658385094, 0.018292682926829267, 0.041537267080745344], 
'DSC09107.JPG': [0.4836672473867596, 0.44642857142857145, 0.023954703832752614, 0.051630434782608696], 
'DSC09108.JPG': [0.4952090592334495, 0.44875776397515527, 0.028963414634146343, 0.04425465838509317], 
'DSC09109.JPG': [0.4719076655052265, 0.4126552795031056, 0.02177700348432056, 0.04930124223602485], 
'DSC09110.JPG': [0.4762630662020906, 0.4138198757763975, 0.027656794425087106, 0.041537267080745344],
'DSC09111.JPG': [0.3118466898954704, 0.29891304347826086, 0.020470383275261322, 0.031055900621118012],
'DSC09112.JPG': [0.4712543554006969, 0.4277950310559006, 0.02221254355400697, 0.040372670807453416],
'DSC09113.JPG': [0.5966898954703833, 0.3536490683229814, 0.01633275261324042, 0.028338509316770188],
'DSC09114.JPG': [0.38501742160278746, 0.3944099378881988, 0.014590592334494773, 0.028338509316770188],
'DSC09115.JPG': [0.44294425087108014, 0.46040372670807456, 0.013937282229965157, 0.02717391304347826], 
'DSC09116.JPG': [0.4732142857142857, 0.48680124223602483, 0.013066202090592335, 0.02406832298136646], 
'DSC09117.JPG': [0.507404181184669, 0.547748447204969, 0.013501742160278746, 0.023291925465838508], 
'DSC09118.JPG': [0.5350609756097561, 0.46040372670807456, 0.009581881533101045, 0.025232919254658384], 
'DSC09119.JPG': [0.5237369337979094, 0.6071428571428571, 0.008710801393728223, 0.017080745341614908],
'DSC09120.JPG': [0.4634146341463415, 0.530667701863354, 0.009581881533101045, 0.016304347826086956],
'DSC09121.JPG': [0.4529616724738676, 0.38004658385093165, 0.010452961672473868, 0.021350931677018632],
'DSC09122.JPG': [0.43096689895470386, 0.40217391304347827, 0.008710801393728223, 0.017080745341614908],
'DSC09123.JPG': [0.47430313588850176, 0.40877329192546585, 0.006968641114982578, 0.017080745341614908], 'DSC09124.JPG': [0.4239982578397213, 0.48020186335403725, 0.008710801393728223, 0.018245341614906832], 'DSC09125.JPG': [0.5315766550522648, 0.49961180124223603, 0.008275261324041812, 0.019021739130434784], 'DSC09126.JPG': [0.625, 0.5291149068322981, 0.010017421602787456, 0.024456521739130436], 'DSC09127.JPG': [0.5104529616724739, 0.5116459627329193, 0.014808362369337979, 0.02872670807453416], 'DSC09128.JPG': [0.45121951219512196, 0.5190217391304348, 0.013719512195121951, 0.027950310559006212], 'DSC09129.JPG': [0.48802264808362367, 0.515527950310559, 0.0156794425087108, 0.026785714285714284], 'DSC09130.JPG': [0.48584494773519166, 0.46156832298136646, 0.013066202090592335, 0.021350931677018632], 'DSC09131.JPG': [0.5500871080139372, 0.4437111801242236, 0.009364111498257839, 0.023680124223602484], 'DSC09132.JPG': [0.4949912891986063, 0.4281832298136646, 0.01088850174216028, 0.027562111801242236], 'DSC09133.JPG': [0.45448606271777003, 0.45419254658385094, 0.010235191637630661, 0.026785714285714284], 'DSC09134.JPG': [0.4259581881533101, 0.44759316770186336, 0.006968641114982578, 0.01591614906832298], 'DSC09135.JPG': [0.4636324041811847, 0.47709627329192544, 0.008928571428571428, 0.015527950310559006], 'DSC09136.JPG': [0.4723432055749129, 0.48874223602484473, 0.010670731707317074, 0.019409937888198756], 'DSC09137.JPG': [0.5189459930313589, 0.453804347826087, 0.01088850174216028, 0.024844720496894408], 'DSC09138.JPG': [0.5988675958188153, 0.5279503105590062, 0.011106271777003485, 0.020574534161490684], 'DSC09139.JPG': [0.45078397212543553, 0.6362577639751553, 0.014590592334494773, 0.021350931677018632], 'DSC09140.JPG': [0.5535714285714286, 0.5201863354037267, 0.012195121951219513, 0.02872670807453416], 'DSC09141.JPG': [0.5568379790940766, 0.3967391304347826, 0.011977351916376307, 0.02096273291925466], 'DSC09142.JPG': [0.5762195121951219, 0.38664596273291924, 0.011977351916376307, 0.01358695652173913], 'DSC09143.JPG': [0.44294425087108014, 0.484860248447205, 0.008057491289198606, 0.012422360248447204], 'DSC09144.JPG': [0.6138937282229965, 0.2826086956521739, 0.01088850174216028, 0.01358695652173913], 'DSC09145.JPG': [0.445993031358885, 0.6024844720496895, 0.008275261324041812, 0.013975155279503106], 'DSC09146.JPG': [0.48671602787456447, 0.2713509316770186, 0.008275261324041812, 0.016692546583850932], 'DSC09147.JPG': [0.40722996515679444, 0.36917701863354035, 0.007186411149825784, 0.015527950310559006], 'DSC09148.JPG': [0.3556184668989547, 0.3955745341614907, 0.009146341463414634, 0.016304347826086956], 'DSC09149.JPG': [0.3641114982578397, 0.4673913043478261, 0.00979965156794425, 0.01358695652173913], 'DSC09150.JPG': [0.3238240418118467, 0.5073757763975155, 0.010017421602787456, 0.015527950310559006], 'DSC09151.JPG': [0.31881533101045295, 0.5543478260869565, 0.013066202090592335, 0.018633540372670808], 'DSC09152.JPG': [0.3353658536585366, 0.6711956521739131, 0.01088850174216028, 0.020186335403726708], 'DSC09153.JPG': [0.4000435540069686, 0.359860248447205, 0.010235191637630661, 0.01436335403726708], 'DSC09154.JPG': [0.4270470383275261, 0.5019409937888198, 0.01088850174216028, 0.02251552795031056], 'DSC09155.JPG': [0.45884146341463417, 0.5077639751552795, 0.008275261324041812, 0.020186335403726708], 'DSC09156.JPG': [0.5117595818815331, 0.4732142857142857, 0.010017421602787456, 0.022127329192546584], 'DSC09157.JPG': [0.5825348432055749, 0.49767080745341613, 0.011977351916376307, 0.021350931677018632], 'DSC09158.JPG': [0.5274390243902439, 0.5240683229813664, 0.013066202090592335, 0.017857142857142856], 'DSC09159.JPG': [0.498911149825784, 0.4557453416149068, 0.011977351916376307, 0.016304347826086956], 'DSC09160.JPG': [0.48715156794425085, 0.4588509316770186, 0.01088850174216028, 0.01358695652173913], 'DSC09161.JPG': [0.47909407665505227, 0.43361801242236025, 0.01088850174216028, 0.012422360248447204], 'DSC09162.JPG': [0.49107142857142855, 0.44992236024844723, 0.009364111498257839, 0.015527950310559006], 'DSC09163.JPG': [0.4854094076655052, 0.42585403726708076, 0.009146341463414634, 0.012422360248447204], 'DSC09164.JPG': [0.5071864111498258, 0.44448757763975155, 0.008928571428571428, 0.015139751552795032], 'DSC09165.JPG': [0.490418118466899, 0.4375, 0.00979965156794425, 0.016304347826086956], 'DSC09166.JPG': [0.4605836236933798, 0.39790372670807456, 0.009146341463414634, 0.014751552795031056], 'DSC09167.JPG': [0.47103658536585363, 0.4188664596273292, 0.010017421602787456, 0.014751552795031056], 'DSC09168.JPG': [0.45492160278745647, 0.41847826086956524, 0.00979965156794425, 0.01436335403726708], 'DSC09169.JPG': [0.46319686411149824, 0.42740683229813664, 0.009364111498257839, 0.013975155279503106], 'DSC09170.JPG': [0.34864982578397213, 0.3427795031055901, 0.009364111498257839, 0.01591614906832298], 'DSC09171.JPG': [0.33405923344947736, 0.3489906832298137, 0.008275261324041812, 0.014751552795031056], 'DSC09172.JPG': [0.2682926829268293, 0.4394409937888199, 0.010017421602787456, 0.014751552795031056], 'DSC09173.JPG': [0.3817508710801394, 0.47709627329192544, 0.009364111498257839, 0.015527950310559006], 'DSC09174.JPG': [0.351698606271777, 0.5256211180124224, 0.01132404181184669, 0.021739130434782608], 'DSC09175.JPG': [0.39176829268292684, 0.625, 0.010452961672473868, 0.022127329192546584], 'DSC09176.JPG': [0.46972996515679444, 0.5345496894409938, 0.011541811846689896, 0.020574534161490684], 'DSC09177.JPG': [0.5032665505226481, 0.5108695652173914, 0.01088850174216028, 0.021350931677018632], 'DSC09178.JPG': [0.5067508710801394, 0.484860248447205, 0.01088850174216028, 0.019021739130434784], 'DSC09179.JPG': [0.5298344947735192, 0.4266304347826087, 0.012195121951219513, 0.016692546583850932], 'DSC09180.JPG': [0.5030487804878049, 0.484083850931677, 0.010235191637630661, 0.01436335403726708], 'DSC09181.JPG': [0.5067508710801394, 0.4048913043478261, 0.01132404181184669, 0.01203416149068323], 'DSC09182.JPG': [0.4864982578397213, 0.5201863354037267, 0.011541811846689896, 0.023291925465838508], 'DSC09183.JPG': [0.438588850174216, 0.4798136645962733, 0.018074912891986063, 0.026009316770186336], 'DSC09184.JPG': [0.43031358885017423, 0.4390527950310559, 0.010235191637630661, 0.015139751552795032], 'DSC09185.JPG': [0.45884146341463417, 0.4514751552795031, 0.0078397212543554, 0.01281055900621118], 
'DSC09186.JPG': [0.4462108013937282, 0.39906832298136646, 0.007186411149825784, 0.012422360248447204], 
'DSC09187.JPG': [0.43314459930313587, 0.29037267080745344, 0.007621951219512195, 0.011645962732919254], 
'DSC09188.JPG': [0.4834494773519164, 0.3998447204968944, 0.007186411149825784, 0.010869565217391304], 
'DSC09189.JPG': [0.48323170731707316, 0.3878105590062112, 0.008710801393728223, 0.010093167701863354],
 'DSC09190.JPG': [0.48497386759581884, 0.4472049689440994, 0.0078397212543554, 0.015139751552795032], 
 'DSC09191.JPG': [0.5067508710801394, 0.41304347826086957, 0.009581881533101045, 0.013198757763975156], 
 'DSC09192.JPG': [0.491506968641115, 0.4180900621118012, 0.011106271777003485, 0.010869565217391304],
'DSC09193.JPG': [0.48671602787456447, 0.44875776397515527, 0.01284843205574913, 0.01281055900621118],
'DSC09194.JPG': [0.49782229965156793, 0.4701086956521739, 0.009581881533101045, 0.013975155279503106], 
'DSC09195.JPG': [0.5037020905923345, 0.49611801242236025, 0.010017421602787456, 0.019021739130434784], 
'DSC09196.JPG': [0.49281358885017423, 0.4200310559006211, 0.010670731707317074, 0.017857142857142856], 
'DSC09197.JPG': [0.48497386759581884, 0.45729813664596275, 0.010670731707317074, 0.017857142857142856],
'DSC09198.JPG': [0.47931184668989546, 0.47903726708074534, 0.01328397212543554, 0.021350931677018632],
'DSC09199.JPG': [0.4649390243902439, 0.4937888198757764, 0.013066202090592335, 0.018633540372670808], 
'DSC09200.JPG': [0.31576655052264807, 0.11218944099378882, 0.007621951219512195, 0.012422360248447204], 
'DSC09201.JPG': [0.31881533101045295, 0.0764751552795031, 0.0078397212543554, 0.011645962732919254],
'DSC09202.JPG': [0.33384146341463417, 0.1750776397515528, 0.007621951219512195, 0.007763975155279503],
'DSC09203.JPG': [0.38218641114982577, 0.10675465838509317, 0.007404181184668989, 0.007763975155279503],
'DSC09204.JPG': [0.5631533101045296, 0.0764751552795031, 0.008057491289198606, 0.008152173913043478], 
'DSC09205.JPG': [0.21232578397212543, 0.31288819875776397, 0.005662020905923345, 0.017857142857142856], 
'DSC09206.JPG': [0.3614982578397213, 0.27406832298136646, 0.005662020905923345, 0.01281055900621118]
    
 }


# In[38]:


#'DSC09088.JPG': [0.4266114982578397, 0.796972049689441, 0.01132404181184669, 0.019409937888198756], 'DSC09089.JPG': [0.7290940766550522, 0.5613354037267081, 0.008493031358885017, 0.019409937888198756], 'DSC09090.JPG': [0.2624128919860627, 0.5062111801242236, 0.007404181184668989, 0.016692546583850932], 'DSC09091.JPG': [0.4797473867595819, 0.48020186335403725, 0.01524390243902439, 0.028338509316770188], 'DSC09092.JPG': [0.49760452961672474, 0.45846273291925466, 0.011977351916376307, 0.026397515527950312], 'DSC09093.JPG': [0.4653745644599303, 0.4763198757763975, 0.011977351916376307, 0.024844720496894408], 'DSC09094.JPG': [0.48323170731707316, 0.48680124223602483, 0.007621951219512195, 0.019409937888198756], 'DSC09095.JPG': [0.5357142857142857, 0.3843167701863354, 0.009581881533101045, 0.019021739130434784], 'DSC09096.JPG': [0.4827961672473868, 0.47903726708074534, 0.016986062717770034, 0.028338509316770188], 'DSC09097.JPG': [0.4701655052264808, 0.5023291925465838, 0.013066202090592335, 0.02562111801242236], 'DSC09098.JPG': [0.2874564459930314, 0.45069875776397517, 0.018945993031358885, 0.033385093167701864], 'DSC09099.JPG': [0.4958623693379791, 0.5054347826086957, 0.016550522648083623, 0.04231366459627329], 'DSC09100.JPG': [0.45492160278745647, 0.7232142857142857, 0.01284843205574913, 0.02872670807453416], 'DSC09101.JPG': [0.29747386759581884, 0.5256211180124224, 0.013719512195121951, 0.019409937888198756], 'DSC09102.JPG': [0.3164198606271777, 0.203027950310559, 0.01088850174216028, 0.017857142857142856], 'DSC09103.JPG': [0.4788763066202091, 0.4635093167701863, 0.01633275261324042, 0.021739130434782608], 'DSC09104.JPG': [0.43314459930313587, 0.12538819875776397, 0.009581881533101045, 0.013975155279503106], 'DSC09105.JPG': [0.6245644599303136, 0.2294254658385093, 0.013501742160278746, 0.023680124223602484], 'DSC09106.JPG': [0.6548344947735192, 0.39169254658385094, 0.018292682926829267, 0.041537267080745344], 'DSC09107.JPG': [0.4836672473867596, 0.44642857142857145, 0.023954703832752614, 0.051630434782608696], 'DSC09108.JPG': [0.4952090592334495, 0.44875776397515527, 0.028963414634146343, 0.04425465838509317], 'DSC09109.JPG': [0.4719076655052265, 0.4126552795031056, 0.02177700348432056, 0.04930124223602485], 'DSC09110.JPG': [0.4762630662020906, 0.4138198757763975, 0.027656794425087106, 0.041537267080745344], 'DSC09111.JPG': [0.3118466898954704, 0.29891304347826086, 0.020470383275261322, 0.031055900621118012], 'DSC09112.JPG': [0.4712543554006969, 0.4277950310559006, 0.02221254355400697, 0.040372670807453416], 'DSC09113.JPG': [0.5966898954703833, 0.3536490683229814, 0.01633275261324042, 0.028338509316770188], 'DSC09114.JPG': [0.38501742160278746, 0.3944099378881988, 0.014590592334494773, 0.028338509316770188], 'DSC09115.JPG': [0.44294425087108014, 0.46040372670807456, 0.013937282229965157, 0.02717391304347826], 'DSC09116.JPG': [0.4732142857142857, 0.48680124223602483, 0.013066202090592335, 0.02406832298136646], 'DSC09117.JPG': [0.507404181184669, 0.547748447204969, 0.013501742160278746, 0.023291925465838508],
#'DSC09118.JPG': [0.5350609756097561, 0.46040372670807456, 0.009581881533101045, 0.025232919254658384], 'DSC09119.JPG': [0.5237369337979094, 0.6071428571428571, 0.008710801393728223, 0.017080745341614908], 'DSC09120.JPG': [0.4634146341463415, 0.530667701863354, 0.009581881533101045, 0.016304347826086956], 'DSC09121.JPG': [0.4529616724738676, 0.38004658385093165, 0.010452961672473868, 0.021350931677018632], 'DSC09122.JPG': [0.43096689895470386, 0.40217391304347827, 0.008710801393728223, 0.017080745341614908], 'DSC09123.JPG': [0.47430313588850176, 0.40877329192546585, 0.006968641114982578, 0.017080745341614908], 'DSC09124.JPG': [0.4239982578397213, 0.48020186335403725, 0.008710801393728223, 0.018245341614906832], 'DSC09125.JPG': [0.5315766550522648, 0.49961180124223603, 0.008275261324041812, 0.019021739130434784], 'DSC09126.JPG': [0.625, 0.5291149068322981, 0.010017421602787456, 0.024456521739130436], 'DSC09127.JPG': [0.5104529616724739, 0.5116459627329193, 0.014808362369337979, 0.02872670807453416], 'DSC09128.JPG': [0.45121951219512196, 0.5190217391304348, 0.013719512195121951, 0.027950310559006212], 'DSC09129.JPG': [0.48802264808362367, 0.515527950310559, 0.0156794425087108, 0.026785714285714284], 'DSC09130.JPG': [0.48584494773519166, 0.46156832298136646, 0.013066202090592335, 0.021350931677018632], 'DSC09131.JPG': [0.5500871080139372, 0.4437111801242236, 0.009364111498257839, 0.023680124223602484], 'DSC09132.JPG': [0.4949912891986063, 0.4281832298136646, 0.01088850174216028, 0.027562111801242236], 'DSC09133.JPG': [0.45448606271777003, 0.45419254658385094, 0.010235191637630661, 0.026785714285714284], 'DSC09134.JPG': [0.4259581881533101, 0.44759316770186336, 0.006968641114982578, 0.01591614906832298], 'DSC09135.JPG': [0.4636324041811847, 0.47709627329192544, 0.008928571428571428, 0.015527950310559006], 'DSC09136.JPG': [0.4723432055749129, 0.48874223602484473, 0.010670731707317074, 0.019409937888198756], 'DSC09137.JPG': [0.5189459930313589, 0.453804347826087, 0.01088850174216028, 0.024844720496894408], 'DSC09138.JPG': [0.5988675958188153, 0.5279503105590062, 0.011106271777003485, 0.020574534161490684], 'DSC09139.JPG': [0.45078397212543553, 0.6362577639751553, 0.014590592334494773, 0.021350931677018632], 'DSC09140.JPG': [0.5535714285714286, 0.5201863354037267, 0.012195121951219513, 0.02872670807453416], 'DSC09141.JPG': [0.5568379790940766, 0.3967391304347826, 0.011977351916376307, 0.02096273291925466], 'DSC09142.JPG': [0.5762195121951219, 0.38664596273291924, 0.011977351916376307, 0.01358695652173913], 'DSC09143.JPG': [0.44294425087108014, 0.484860248447205, 0.008057491289198606, 0.012422360248447204], 'DSC09144.JPG': [0.6138937282229965, 0.2826086956521739, 0.01088850174216028, 0.01358695652173913], 'DSC09145.JPG': [0.445993031358885, 0.6024844720496895, 0.008275261324041812, 0.013975155279503106], 'DSC09146.JPG': [0.48671602787456447, 0.2713509316770186, 0.008275261324041812, 0.016692546583850932], 'DSC09147.JPG': [0.40722996515679444, 0.36917701863354035, 0.007186411149825784, 0.015527950310559006],
# 'DSC09148.JPG': [0.3556184668989547, 0.3955745341614907, 0.009146341463414634, 0.016304347826086956], 'DSC09149.JPG': [0.3641114982578397, 0.4673913043478261, 0.00979965156794425, 0.01358695652173913], 'DSC09150.JPG': [0.3238240418118467, 0.5073757763975155, 0.010017421602787456, 0.015527950310559006], 'DSC09151.JPG': [0.31881533101045295, 0.5543478260869565, 0.013066202090592335, 0.018633540372670808], 'DSC09152.JPG': [0.3353658536585366, 0.6711956521739131, 0.01088850174216028, 0.020186335403726708], 'DSC09153.JPG': [0.4000435540069686, 0.359860248447205, 0.010235191637630661, 0.01436335403726708], 'DSC09154.JPG': [0.4270470383275261, 0.5019409937888198, 0.01088850174216028, 0.02251552795031056], 'DSC09155.JPG': [0.45884146341463417, 0.5077639751552795, 0.008275261324041812, 0.020186335403726708], 'DSC09156.JPG': [0.5117595818815331, 0.4732142857142857, 0.010017421602787456, 0.022127329192546584], 'DSC09157.JPG': [0.5825348432055749, 0.49767080745341613, 0.011977351916376307, 0.021350931677018632], 'DSC09158.JPG': [0.5274390243902439, 0.5240683229813664, 0.013066202090592335, 0.017857142857142856], 'DSC09159.JPG': [0.498911149825784, 0.4557453416149068, 0.011977351916376307, 0.016304347826086956], 'DSC09160.JPG': [0.48715156794425085, 0.4588509316770186, 0.01088850174216028, 0.01358695652173913], 'DSC09161.JPG': [0.47909407665505227, 0.43361801242236025, 0.01088850174216028, 0.012422360248447204], 'DSC09162.JPG': [0.49107142857142855, 0.44992236024844723, 0.009364111498257839, 0.015527950310559006], 'DSC09163.JPG': [0.4854094076655052, 0.42585403726708076, 0.009146341463414634, 0.012422360248447204], 'DSC09164.JPG': [0.5071864111498258, 0.44448757763975155, 0.008928571428571428, 0.015139751552795032], 'DSC09165.JPG': [0.490418118466899, 0.4375, 0.00979965156794425, 0.016304347826086956], 'DSC09166.JPG': [0.4605836236933798, 0.39790372670807456, 0.009146341463414634, 0.014751552795031056], 'DSC09167.JPG': [0.47103658536585363, 0.4188664596273292, 0.010017421602787456, 0.014751552795031056], 'DSC09168.JPG': [0.45492160278745647, 0.41847826086956524, 0.00979965156794425, 0.01436335403726708], 'DSC09169.JPG': [0.46319686411149824, 0.42740683229813664, 0.009364111498257839, 0.013975155279503106], 'DSC09170.JPG': [0.34864982578397213, 0.3427795031055901, 0.009364111498257839, 0.01591614906832298], 'DSC09171.JPG': [0.33405923344947736, 0.3489906832298137, 0.008275261324041812, 0.014751552795031056], 'DSC09172.JPG': [0.2682926829268293, 0.4394409937888199, 0.010017421602787456, 0.014751552795031056], 'DSC09173.JPG': [0.3817508710801394, 0.47709627329192544, 0.009364111498257839, 0.015527950310559006], 'DSC09174.JPG': [0.351698606271777, 0.5256211180124224, 0.01132404181184669, 0.021739130434782608], 'DSC09175.JPG': [0.39176829268292684, 0.625, 0.010452961672473868, 0.022127329192546584], 'DSC09176.JPG': [0.46972996515679444, 0.5345496894409938, 0.011541811846689896, 0.020574534161490684], 'DSC09177.JPG': [0.5032665505226481, 0.5108695652173914, 0.01088850174216028, 0.021350931677018632],
#'DSC09178.JPG': [0.5067508710801394, 0.484860248447205, 0.01088850174216028, 0.019021739130434784], 'DSC09179.JPG': [0.5298344947735192, 0.4266304347826087, 0.012195121951219513, 0.016692546583850932], 'DSC09180.JPG': [0.5030487804878049, 0.484083850931677, 0.010235191637630661, 0.01436335403726708], 'DSC09181.JPG': [0.5067508710801394, 0.4048913043478261, 0.01132404181184669, 0.01203416149068323], 'DSC09182.JPG': [0.4864982578397213, 0.5201863354037267, 0.011541811846689896, 0.023291925465838508], 'DSC09183.JPG': [0.438588850174216, 0.4798136645962733, 0.018074912891986063, 0.026009316770186336], 'DSC09184.JPG': [0.43031358885017423, 0.4390527950310559, 0.010235191637630661, 0.015139751552795032], 'DSC09185.JPG': [0.45884146341463417, 0.4514751552795031, 0.0078397212543554, 0.01281055900621118], 'DSC09186.JPG': [0.4462108013937282, 0.39906832298136646, 0.007186411149825784, 0.012422360248447204], 'DSC09187.JPG': [0.43314459930313587, 0.29037267080745344, 0.007621951219512195, 0.011645962732919254], 'DSC09188.JPG': [0.4834494773519164, 0.3998447204968944, 0.007186411149825784, 0.010869565217391304], 'DSC09189.JPG': [0.48323170731707316, 0.3878105590062112, 0.008710801393728223, 0.010093167701863354], 'DSC09190.JPG': [0.48497386759581884, 0.4472049689440994, 0.0078397212543554, 0.015139751552795032], 'DSC09191.JPG': [0.5067508710801394, 0.41304347826086957, 0.009581881533101045, 0.013198757763975156], 'DSC09192.JPG': [0.491506968641115, 0.4180900621118012, 0.011106271777003485, 0.010869565217391304], 'DSC09193.JPG': [0.48671602787456447, 0.44875776397515527, 0.01284843205574913, 0.01281055900621118], 'DSC09194.JPG': [0.49782229965156793, 0.4701086956521739, 0.009581881533101045, 0.013975155279503106], 'DSC09195.JPG': [0.5037020905923345, 0.49611801242236025, 0.010017421602787456, 0.019021739130434784], 'DSC09196.JPG': [0.49281358885017423, 0.4200310559006211, 0.010670731707317074, 0.017857142857142856], 'DSC09197.JPG': [0.48497386759581884, 0.45729813664596275, 0.010670731707317074, 0.017857142857142856], 'DSC09198.JPG': [0.47931184668989546, 0.47903726708074534, 0.01328397212543554, 0.021350931677018632], 'DSC09199.JPG': [0.4649390243902439, 0.4937888198757764, 0.013066202090592335, 0.018633540372670808], 'DSC09200.JPG': [0.31576655052264807, 0.11218944099378882, 0.007621951219512195, 0.012422360248447204], 'DSC09201.JPG': [0.31881533101045295, 0.0764751552795031, 0.0078397212543554, 0.011645962732919254], 'DSC09202.JPG': [0.33384146341463417, 0.1750776397515528, 0.007621951219512195, 0.007763975155279503], 'DSC09203.JPG': [0.38218641114982577, 0.10675465838509317, 0.007404181184668989, 0.007763975155279503], 'DSC09204.JPG': [0.5631533101045296, 0.0764751552795031, 0.008057491289198606, 0.008152173913043478], 'DSC09205.JPG': [0.21232578397212543, 0.31288819875776397, 0.005662020905923345, 0.017857142857142856], 'DSC09206.JPG': [0.3614982578397213, 0.27406832298136646, 0.005662020905923345, 0.01281055900621118], 'dot1.JPG': [0.5855836236933798, 0.7701863354037267, 0.015461672473867595, 0.027950310559006212],
#'dot2.JPG': [0.5786149825783972, 0.796972049689441, 0.01132404181184669, 0.019409937888198756], 'dot3.JPG': [0.4266114982578397, 1.2597049689440993, 0.01132404181184669, 0.019409937888198756], 'dot4.JPG': [0.7312717770034843, 0.4751552795031056, 0.010452961672473868, 0.022127329192546584], 'dot5.JPG': [0.9540505226480837, 0.5613354037267081, 0.008493031358885017, 0.019409937888198756], 'dot6.JPG': [0.7290940766550522, 0.624611801242236, 0.008493031358885017, 0.019409937888198756], 'dot7.JPG': [0.42334494773519166, 0.8881987577639752, 0.01132404181184669, 0.018245341614906832], 'dot8.JPG': [0.6733449477351916, 0.5062111801242236, 0.007404181184668989, 0.016692546583850932], 'dot9.JPG': [0.2624128919860627, 0.7829968944099379, 0.007404181184668989, 0.016692546583850932], 'dot10.JPG': [0.4769163763066202, 0.48524844720496896, 0.02025261324041812, 0.036490683229813664], 'dot11.JPG': [0.9333623693379791, 0.48020186335403725, 0.01524390243902439, 0.028338509316770188], 'dot12.JPG': [0.4797473867595819, 0.5574534161490683, 0.01524390243902439, 0.028338509316770188], 'dot13.JPG': [0.4764808362369338, 0.47903726708074534, 0.0156794425087108, 0.023680124223602484], 'dot14.JPG': [0.5385452961672473, 0.45846273291925466, 0.011977351916376307, 0.026397515527950312], 'dot15.JPG': [0.49760452961672474, 0.9557453416149069, 0.011977351916376307, 0.026397515527950312], 'dot16.JPG': [0.46276132404181186, 0.49145962732919257, 0.016114982578397212, 0.030279503105590064], 'dot17.JPG': [0.7846254355400697, 0.4763198757763975, 0.011977351916376307, 0.024844720496894408], 'dot18.JPG': [0.4653745644599303, 0.8016304347826086, 0.011977351916376307, 0.024844720496894408], 'dot19.JPG': [0.4827961672473868, 0.5023291925465838, 0.013066202090592335, 0.023291925465838508], 'dot20.JPG': [0.6387195121951219, 0.48680124223602483, 0.007621951219512195, 0.019409937888198756], 'dot21.JPG': [0.48323170731707316, 0.9794254658385093, 0.007621951219512195, 0.019409937888198756], 'dot22.JPG': [0.5004355400696864, 0.359472049689441, 0.013501742160278746, 0.024844720496894408], 'dot23.JPG': [0.8826219512195121, 0.3843167701863354, 0.009581881533101045, 0.019021739130434784], 'dot24.JPG': [0.5357142857142857, 0.42391304347826086, 0.009581881533101045, 0.019021739130434784], 'dot25.JPG': [0.48236062717770034, 0.4782608695652174, 0.016986062717770034, 0.028338509316770188], 'dot26.JPG': [0.5866724738675958, 0.47903726708074534, 0.016986062717770034, 0.028338509316770188], 'dot27.JPG': [0.4827961672473868, 0.8629658385093167, 0.016986062717770034, 0.028338509316770188], 'dot28.JPG': [0.08188153310104529, 0.49301242236024845, 0.0156794425087108, 0.026009316770186336], 'dot29.JPG': [0.518074912891986, 0.5023291925465838, 0.013066202090592335, 0.02562111801242236], 'dot30.JPG': [0.4701655052264808, 1.0539596273291925, 0.013066202090592335, 0.02562111801242236], 'dot31.JPG': [0.28723867595818814, 0.4518633540372671, 0.018945993031358885, 0.03377329192546584],
#'dot32.JPG': [0.7772212543554007, 0.45069875776397517, 0.018945993031358885, 0.033385093167701864], 'dot33.JPG': [0.2874564459930314, 0.6385869565217391, 0.018945993031358885, 0.033385093167701864], 'dot34.JPG': [0.20905923344947736, 0.33656832298136646, 0.028963414634146343, 0.04736024844720497], 'dot35.JPG': [0.6520034843205574, 0.5054347826086957, 0.016550522648083623, 0.04231366459627329], 'dot36.JPG': [0.4958623693379791, 1.0593944099378882, 0.016550522648083623, 0.04231366459627329], 'dot37.JPG': [0.5533536585365854, 0.7014751552795031, 0.02025261324041812, 0.036490683229813664], 'dot38.JPG': [0.6195557491289199, 0.7232142857142857, 0.01284843205574913, 0.02872670807453416], 'dot39.JPG': [0.45492160278745647, 0.7666925465838509, 0.01284843205574913, 0.02872670807453416], 'dot40.JPG': [0.3007404181184669, 0.5667701863354038, 0.014808362369337979, 0.02251552795031056], 'dot41.JPG': [0.3133710801393728, 0.5256211180124224, 0.013719512195121951, 0.019409937888198756], 'dot42.JPG': [0.29747386759581884, 0.6882763975155279, 0.013719512195121951, 0.019409937888198756], 'dot43.JPG': [0.27961672473867594, 0.2923136645962733, 0.013066202090592335, 0.022127329192546584], 'dot44.JPG': [0.5701219512195121, 0.203027950310559, 0.01088850174216028, 0.017857142857142856], 'dot45.JPG': [0.3164198606271777, 0.6649844720496895, 0.01088850174216028, 0.017857142857142856], 'dot46.JPG': [0.476698606271777, 0.5031055900621118, 0.014372822299651568, 0.03183229813664596], 'dot47.JPG': [0.7580574912891986, 0.4635093167701863, 0.01633275261324042, 0.021739130434782608], 'dot48.JPG': [0.4788763066202091, 0.7550465838509317, 0.01633275261324042, 0.021739130434782608], 'dot49.JPG': [0.2850609756097561, 0.5706521739130435, 0.008493031358885017, 0.018245341614906832], 'dot50.JPG': [0.7190766550522648, 0.12538819875776397, 0.009581881533101045, 0.013975155279503106], 'dot51.JPG': [0.43314459930313587, 0.6063664596273292, 0.009581881533101045, 0.013975155279503106], 'dot52.JPG': [0.40156794425087106, 0.17430124223602483, 0.01720383275261324, 0.030667701863354036], 'dot53.JPG': [1.0875435540069687, 0.2294254658385093, 0.013501742160278746, 0.023680124223602484], 'dot54.JPG': [0.6245644599303136, 0.5970496894409938, 0.013501742160278746, 0.023680124223602484], 'dot55.JPG': [0.5161149825783972, 0.17585403726708074, 0.029181184668989547, 0.047748447204968944], 'dot56.JPG': [0.697081881533101, 0.39169254658385094, 0.018292682926829267, 0.041537267080745344], 'dot57.JPG': [0.6548344947735192, 0.671583850931677, 0.018292682926829267, 0.041537267080745344], 'dot58.JPG': [0.46755226480836237, 0.45108695652173914, 0.03723867595818815, 0.06677018633540373], 'dot59.JPG': [0.8246951219512195, 0.44642857142857145, 0.023954703832752614, 0.051630434782608696], 'dot60.JPG': [0.4836672473867596, 0.9417701863354038, 0.023954703832752614, 0.051630434782608696], 'dot61.JPG': [0.47147212543554007, 0.4406055900621118, 0.03397212543554007, 0.06444099378881987],
#'dot62.JPG': [0.8723867595818815, 0.44875776397515527, 0.028963414634146343, 0.04425465838509317], 'dot63.JPG': [0.4952090592334495, 0.8633540372670807, 0.028963414634146343, 0.04425465838509317], 'dot64.JPG': [0.13044425087108014, 0.3330745341614907, 0.034625435540069686, 0.057065217391304345], 'dot65.JPG': [0.5322299651567944, 0.4126552795031056, 0.02177700348432056, 0.04930124223602485], 'dot66.JPG': [0.4719076655052265, 1.2791149068322982, 0.02177700348432056, 0.04930124223602485], 'dot67.JPG': [0.46755226480836237, 0.4138198757763975, 0.031576655052264806, 0.05007763975155279], 'dot68.JPG': [0.622822299651568, 0.4138198757763975, 0.027656794425087106, 0.041537267080745344], 'dot69.JPG': [0.4762630662020906, 0.6944875776397516, 0.027656794425087106, 0.041537267080745344], 'dot70.JPG': [0.28614982578397213, 0.562888198757764, 0.026785714285714284, 0.047748447204968944], 'dot71.JPG': [0.3606271777003484, 0.29891304347826086, 0.020470383275261322, 0.031055900621118012], 'dot72.JPG': [0.3118466898954704, 0.3656832298136646, 0.020470383275261322, 0.031055900621118012], 'dot73.JPG': [0.4701655052264808, 0.4277950310559006, 0.022865853658536585, 0.04114906832298137], 'dot74.JPG': [0.4873693379790941, 0.4277950310559006, 0.02221254355400697, 0.040372670807453416], 'dot75.JPG': [0.4712543554006969, 0.5656055900621118, 0.02221254355400697, 0.040372670807453416], 'dot76.JPG': [0.3641114982578397, 0.10986024844720498, 0.02264808362369338, 0.03998447204968944], 'dot77.JPG': [0.7970383275261324, 0.3536490683229814, 0.01633275261324042, 0.028338509316770188], 'dot78.JPG': [0.5966898954703833, 1.0974378881987579, 0.01633275261324042, 0.028338509316770188], 'dot79.JPG': [0.38044425087108014, 0.4095496894409938, 0.0156794425087108, 0.030667701863354036], 'dot80.JPG': [0.4220383275261324, 0.3944099378881988, 0.014590592334494773, 0.028338509316770188], 'dot81.JPG': [0.38501742160278746, 0.6277173913043478, 0.014590592334494773, 0.028338509316770188], 'dot82.JPG': [0.44185540069686413, 0.46389751552795033, 0.014590592334494773, 0.028338509316770188], 'dot83.JPG': [0.6794425087108014, 0.46040372670807456, 0.013937282229965157, 0.02717391304347826], 'dot84.JPG': [0.44294425087108014, 0.9134316770186336, 0.013937282229965157, 0.02717391304347826], 'dot85.JPG': [0.4721254355400697, 0.4957298136645963, 0.016986062717770034, 0.030279503105590064], 'dot86.JPG': [0.7750435540069687, 0.48680124223602483, 0.013066202090592335, 0.02406832298136646], 'dot87.JPG': [0.4732142857142857, 0.6172360248447205, 0.013066202090592335, 0.02406832298136646], 'dot88.JPG': [0.518074912891986, 0.5267857142857143, 0.017857142857142856, 0.031444099378881984], 'dot89.JPG': [0.9418554006968641, 0.547748447204969, 0.013501742160278746, 0.023291925465838508], 'dot90.JPG': [0.507404181184669, 0.6696428571428571, 0.013501742160278746, 0.023291925465838508], 'dot91.JPG': [0.5047909407665505, 0.41304347826086957, 0.01720383275261324, 0.029114906832298136],
#'dot92.JPG': [0.5546602787456446, 0.46040372670807456, 0.009581881533101045, 0.025232919254658384], 'dot93.JPG': [0.5350609756097561, 0.7371894409937888, 0.009581881533101045, 0.025232919254658384], 'dot94.JPG': [0.5627177700348432, 0.45729813664596275, 0.010670731707317074, 0.01746894409937888], 'dot95.JPG': [0.8741289198606271, 0.6071428571428571, 0.008710801393728223, 0.017080745341614908], 'dot96.JPG': [0.5237369337979094, 1.0888975155279503, 0.008710801393728223, 0.017080745341614908], 'dot97.JPG': [0.49020034843205573, 0.5566770186335404, 0.01328397212543554, 0.023291925465838508], 'dot98.JPG': [0.7767857142857143, 0.530667701863354, 0.009581881533101045, 0.016304347826086956], 'dot99.JPG': [0.4634146341463415, 0.8520962732919255, 0.009581881533101045, 0.016304347826086956], 'dot100.JPG': [0.4202961672473868, 0.5186335403726708, 0.015026132404181184, 0.025232919254658384], 'dot101.JPG': [0.5289634146341463, 0.38004658385093165, 0.010452961672473868, 0.021350931677018632], 'dot102.JPG': [0.4529616724738676, 0.5489130434782609, 0.010452961672473868, 0.021350931677018632], 'dot103.JPG': [0.41180313588850176, 0.4879658385093168, 0.012630662020905924, 0.022903726708074536], 'dot104.JPG': [0.7282229965156795, 0.40217391304347827, 0.008710801393728223, 0.017080745341614908], 'dot105.JPG': [0.43096689895470386, 0.7837732919254659, 0.008710801393728223, 0.017080745341614908], 'dot106.JPG': [0.3007404181184669, 0.2923136645962733, 0.011106271777003485, 0.02096273291925466], 'dot107.JPG': [0.5, 0.40877329192546585, 0.006968641114982578, 0.017080745341614908], 'dot108.JPG': [0.47430313588850176, 1.0679347826086956, 0.006968641114982578, 0.017080745341614908], 'dot109.JPG': [0.45492160278745647, 0.5970496894409938, 0.013066202090592335, 0.022127329192546584], 'dot110.JPG': [0.4882404181184669, 0.48020186335403725, 0.008710801393728223, 0.018245341614906832], 'dot111.JPG': [0.4239982578397213, 0.5636645962732919, 0.008710801393728223, 0.018245341614906832], 'dot112.JPG': [0.5082752613240418, 0.4312888198757764, 0.012630662020905924, 0.019409937888198756], 'dot113.JPG': [0.5960365853658537, 0.49961180124223603, 0.008275261324041812, 0.019021739130434784], 'dot114.JPG': [0.5315766550522648, 0.9580745341614907, 0.008275261324041812, 0.019021739130434784], 'dot115.JPG': [0.6030052264808362, 0.46816770186335405, 0.01132404181184669, 0.026009316770186336], 'dot116.JPG': [0.8179442508710801, 0.5291149068322981, 0.010017421602787456, 0.024456521739130436], 'dot117.JPG': [0.625, 0.8462732919254659, 0.010017421602787456, 0.024456521739130436], 'dot118.JPG': [0.510670731707317, 0.5089285714285714, 0.0156794425087108, 0.030279503105590064], 'dot119.JPG': [0.8048780487804879, 0.5116459627329193, 0.014808362369337979, 0.02872670807453416], 'dot120.JPG': [0.5104529616724739, 0.6312111801242236, 0.014808362369337979, 0.02872670807453416], 'dot121.JPG': [0.46668118466898956, 0.5520186335403726, 0.02025261324041812, 0.03687888198757764],
# 'dot332.JPG': [0.6722560975609756, 0.47903726708074534, 0.01328397212543554, 0.021350931677018632], 'dot333.JPG': [0.47931184668989546, 0.6447981366459627, 0.01328397212543554, 0.021350931677018632], 'dot334.JPG': [0.4647212543554007, 0.49417701863354035, 0.01328397212543554, 0.019021739130434784], 'dot335.JPG': [0.47452090592334495, 0.4937888198757764, 0.013066202090592335, 0.018633540372670808], 'dot336.JPG': [0.4649390243902439, 0.8854813664596274, 0.013066202090592335, 0.018633540372670808], 'dot337.JPG': [0.22190766550522648, 0.3796583850931677, 0.010235191637630661, 0.017857142857142856], 'dot338.JPG': [0.3288327526132404, 0.11218944099378882, 0.007621951219512195, 0.012422360248447204], 'dot339.JPG': [0.31576655052264807, 0.30861801242236025, 0.007621951219512195, 0.012422360248447204], 'dot340.JPG': [-0.010452961672473868, 0.24922360248447206, 0.010235191637630661, 0.018245341614906832], 'dot341.JPG': [0.5487804878048781, 0.0764751552795031, 0.0078397212543554, 0.011645962732919254], 'dot342.JPG': [0.31881533101045295, 0.41226708074534163, 0.0078397212543554, 0.011645962732919254], 'dot343.JPG': [0.2547909407665505, 0.5372670807453416, 0.008057491289198606, 0.015527950310559006], 'dot344.JPG': [0.7158101045296167, 0.1750776397515528, 0.007621951219512195, 0.007763975155279503], 'dot345.JPG': [0.33384146341463417, 0.22010869565217392, 0.007621951219512195, 0.007763975155279503], 'dot346.JPG': [0.3231707317073171, 0.18090062111801242, 0.008275261324041812, 0.01125776397515528], 'dot347.JPG': [0.8780487804878049, 0.10675465838509317, 0.007404181184668989, 0.007763975155279503], 'dot348.JPG': [0.38218641114982577, 0.22282608695652173, 0.007404181184668989, 0.007763975155279503], 'dot349.JPG': [0.4096254355400697, 0.08385093167701864, 0.009146341463414634, 0.015139751552795032], 'dot350.JPG': [1.0335365853658536, 0.0764751552795031, 0.008057491289198606, 0.008152173913043478], 'dot351.JPG': [0.5631533101045296, 0.27290372670807456, 0.008057491289198606, 0.008152173913043478], 'dot352.JPG': [0.2029616724738676, 0.6269409937888198, 0.010235191637630661, 0.020574534161490684], 'dot353.JPG': [0.6635452961672473, 0.31288819875776397, 0.005662020905923345, 0.017857142857142856], 'dot354.JPG': [0.21232578397212543, 0.7740683229813664, 0.005662020905923345, 0.017857142857142856], 'dot355.JPG': [0.31424216027874563, 0.5415372670807453, 0.009146341463414634, 0.01591614906832298], 'dot356.JPG': [0.7086236933797909, 0.27406832298136646, 0.005662020905923345, 0.01281055900621118], 'dot357.JPG': [0.3614982578397213, 0.4440993788819876, 0.005662020905923345, 0.01281055900621118]


# In[45]:


count = 0


# In[7]:


import numpy as np
import cv2
import matplotlib.pyplot as plt
from azure.cognitiveservices.vision.customvision.training import CustomVisionTrainingClient
from azure.cognitiveservices.vision.customvision.training.models import ImageFileCreateEntry, Region
import time
import xml.dom.minidom as xmldom
import os
import random

def height_shift_image( image, height_shift_range, boundingbox ):
    
    img_height, img_width = image.shape[:2]
    factor = height_shift_range * img_height
    
    M = np.float32([[1,0,0],[0,1,factor]]) 
    shifted_image = cv2.warpAffine( image, M, (img_width, img_height) )
    
    # compute new bounding box    
    shifted_point_A = np.matmul( M, np.array( [boundingbox[0], boundingbox[1], 1] ).T )   
    shifted_point_C = np.matmul( M, np.array( [boundingbox[2], boundingbox[3], 1] ).T )   
    
    new_boundingbox = [ shifted_point_A[0].astype(int), shifted_point_A[1].astype(int), 
                        shifted_point_C[0].astype(int), shifted_point_C[1].astype(int) ]
    
    return shifted_image, new_boundingbox

def width_shift_image( image, width_shift_range, boundingbox ):
    
    img_height, img_width = image.shape[:2]
    factor = img_width * width_shift_range
    
    M = np.float32([[1,0,factor],[0,1,0]]) 
    shifted_image = cv2.warpAffine( image, M, (img_width, img_height) )
    
    # compute new bounding box    
    shifted_point_A = np.matmul( M, np.array( [boundingbox[0], boundingbox[1], 1] ).T )   
    shifted_point_C = np.matmul( M, np.array( [boundingbox[2], boundingbox[3], 1] ).T )   
    
    new_boundingbox = [ shifted_point_A[0].astype(int), shifted_point_A[1].astype(int), 
                        shifted_point_C[0].astype(int), shifted_point_C[1].astype(int) ]
    
    return shifted_image, new_boundingbox
def rotate_image( image, angle, bounding_box ):
    
    # get image dimension
    img_height, img_width = image.shape[:2]
    
    # get rotation matrix
    rotation_matrix = cv2.getRotationMatrix2D( center = (img_width // 2, img_height // 2), angle = angle, scale = 1.0 )
   
    # apply transformation (ratate image) 
    rotated_image = cv2.warpAffine( image, rotation_matrix, (img_width, img_height) )
    
    # --- compute new bounding box ---
    # Apply same transformation to the four bounding box corners
    rotated_point_A = np.matmul( rotation_matrix, np.array( [bounding_box[0], bounding_box[1], 1] ).T )   
    rotated_point_B = np.matmul( rotation_matrix, np.array( [bounding_box[2], bounding_box[1], 1] ).T )   
    rotated_point_C = np.matmul( rotation_matrix, np.array( [bounding_box[2], bounding_box[3], 1] ).T )   
    rotated_point_D = np.matmul( rotation_matrix, np.array( [bounding_box[0], bounding_box[3], 1] ).T )   
    # Compute new bounding box, that is, the bounding box for rotated object
    x = np.array( [ rotated_point_A[0], rotated_point_B[0], rotated_point_C[0], rotated_point_D[0] ])
    y = np.array( [ rotated_point_A[1], rotated_point_B[1], rotated_point_C[1], rotated_point_D[1] ])
    new_boundingbox = [np.min( x ).astype(int), np.min( y ).astype(int), np.max( x ).astype(int), np.max( y ).astype(int)]
    
    return rotated_image, new_boundingbox
def scale_image( image, scale_factor, boundingbox ):

    img_height, img_width = img.shape[:2]

    width = (int)(scale_factor * img_width)
    height = (int)(scale_factor * img_height)
    
    scaled_img = cv2.resize( image, (width,height) )

    scaling_marix = np.array( [ [scale_factor, 0, 0], [0, scale_factor, 0], [0, 0, scale_factor] ] )

    scaled_point_A = np.matmul( scaling_marix, np.array( [boundingbox[0], boundingbox[1], 1] ).T )   
    scaled_point_C = np.matmul( scaling_marix, np.array( [boundingbox[2], boundingbox[3], 1] ).T )   

    new_boundingbox = [ scaled_point_A[0].astype(int), scaled_point_A[1].astype(int), 
                        scaled_point_C[0].astype(int), scaled_point_C[1].astype(int) ]
    
    return scaled_img, new_boundingbox

t_dic = { "rotation":rotate_image, "width_shift":width_shift_image, "height_shift":height_shift_image, "scale": scale_image }
f_dic = { "rotation":(0, 90), "width_shift":(0, 0.5), "height_shift":(0, 0.5), "scale": (0.5, 1.5)}


def apply_transformation( image, bounding_box, transformation, n ):   
    t_images_list = []
    
    for i in range(0, n):
        interval = f_dic[transformation]
        factor = random.uniform(interval[0], interval[1])
        img, bb = t_dic[transformation]( image, factor, bounding_box )
        t_images_list.append( (img, bb, factor) )

    return t_images_list
def draw_boundingbox( image, tl, br ):
    copied_image = image.copy()
    image = cv2.rectangle(copied_image, tl, br, (0, 0, 255), 10)
    image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)          
    return image


def plot_images( images_list ):
    global count
    import math
    num_cols = 5
    num_rows = math.ceil( len(images_list) / num_cols )
    figsize = (10,10)
    fig = plt.figure()
    

    for i in range (0, len(images_list) ):
        info = images_list[i]
        x1, y1, x2, y2 = info[1]       
        image = draw_boundingbox( info[0], (x1, y1), (x2, y2) )      
        axi = fig.add_subplot(num_rows, num_cols, i+1)
        #axi.axis( 'off' )
        axi.set_title( ("%.1f" % info[2] ) )
        image = image[:,:,[2,1,0]]
        cv2.imwrite("C:\\Users\\v-jelin\\Pictures\\test\\"+ "dot" + str(count+1) + ".JPG", info[0][:,:,[2,1,0]])       
        print(count+1)
        print("資料擴增後的像素位置"+str(info[1]))
        #plt.imshow(image)
        #plt.show()
        dot_image_regions["dot"+str(count+1) + ".JPG"] = [x1/4592, y1/2576, (x2-x1)/4592, (y2-y1)/2576]  
        count = count + 1
        print("新增的dict圖片和標準化座標"+str(dot_image_regions))

        

#取得xml檔資料xywh--------------------------------------------------
def parse_xml(fn):
    xml_file = xmldom.parse(fn)
    eles = xml_file.documentElement
    #print(eles.tagName)
    xmin = eles.getElementsByTagName("xmin")[0].firstChild.data
    xmax = eles.getElementsByTagName("xmax")[0].firstChild.data
    ymin = eles.getElementsByTagName("ymin")[0].firstChild.data
    ymax = eles.getElementsByTagName("ymax")[0].firstChild.data
    #width = eles.getElementsByTagName("width")[0].firstChild.data
    #height = eles.getElementsByTagName("height")[0].firstChild.data
    return [xmin,ymin,xmax, ymax]





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# # 黑點資料

# In[47]:


original_boundingbox = []
xmlDirPath = 'C:\\Users\\v-jelin\\Pictures\\dotLabel\\'
files= os.listdir(xmlDirPath)
for filename in files: #遍歷資料夾   
    original_boundingbox.append(parse_xml(xmlDirPath+ filename))#取得所有xml檔裡面的xywh  


# In[48]:


imageDirPath="C:\\Users\\v-jelin\\Pictures\\dot\\"
imgfiles= os.listdir(imageDirPath)
for i in range(len(original_boundingbox)):    
    original_boundingbox[i] = list(map(int, original_boundingbox[i])) #str list to int list
    for j in range(len(imgfiles)):
        if(i == j):
            img = cv2.imread(imageDirPath + imgfiles[j])
            img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) 
            
            rotated_images = apply_transformation( img, original_boundingbox[i], "rotation", 3 )
            plot_images(rotated_images)

            w_shifted_images = apply_transformation( img, original_boundingbox[i], "width_shift", 3 )
            plot_images(w_shifted_images)

            h_shifted_images = apply_transformation( img, original_boundingbox[i], "height_shift", 3 )
            plot_images(h_shifted_images)


# # SDK

# In[49]:


# Update this with the path to where you downloaded the images.
base_image_url = "C:\\Users\\v-jelin\\Pictures\\test\\"

# Go through the data table above and create the images
print ("Adding images...")
tagged_images_with_regions = []
count = 0
for file_name in dot_image_regions.keys():
    
    x,y,w,h = dot_image_regions[file_name]
    regions = [ Region(tag_id=dot_tag.id, left=x,top=y,width=w,height=h) ]

    with open(base_image_url + file_name, mode="rb") as image_contents:
        tagged_images_with_regions.append(ImageFileCreateEntry(name=file_name, contents=image_contents.read(), regions=regions))

    count = count+1
    print(count)
    if(count == 30):
        upload_result = trainer.create_images_from_files(project.id, images=tagged_images_with_regions)
        #upload_result = trainer.create_images_from_files(project.id, images=tagged_images_with_regions)
        if not upload_result.is_batch_successful:
            print("Image batch upload failed.")
            for image in upload_result.images:
                print("Image status: ", image.status)
            exit(-1)
        tagged_images_with_regions=[]
        count = 0       
        print ("OK...")


# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[32]:


dot_image_regions2 ={
     'DSC09207.JPG': [0.30640243902439024, 0.5535714285714286, 0.29769163763066203, 0.22903726708074534], 'DSC09208.JPG': [0.28027003484320556, 0.6622670807453416, 0.18662891986062718, 0.2573757763975155], 'DSC09209.JPG': [0.42748257839721254, 0.5353260869565217, 0.17007839721254356, 0.29774844720496896], 'DSC09210.JPG': [0.3913327526132404, 0.7053571428571429, 0.2846254355400697, 0.19409937888198758], 'DSC09211.JPG': [0.43706445993031356, 0.7154503105590062, 0.3501742160278746, 0.14596273291925466], 'DSC09212.JPG': [0.5971254355400697, 0.7923136645962733, 0.24303135888501742, 0.14285714285714285], 'DSC09213.JPG': [0.48214285714285715, 0.7360248447204969, 0.24107142857142858, 0.19177018633540371], 'DSC09214.JPG': [0.5925522648083623, 0.3307453416149068, 0.05226480836236934, 0.30551242236024845], 'DSC09215.JPG': [0.37826655052264807, 0.7282608695652174, 0.24041811846689895, 0.12305900621118013], 'DSC09216.JPG': [0.4455574912891986, 0.6222826086956522, 0.20644599303135888, 0.19021739130434784], 'DSC09217.JPG': [0.07774390243902439, 0.6067546583850931, 0.1994773519163763, 0.20574534161490685], 'DSC09218.JPG': [0.1291376306620209, 0.7631987577639752, 0.2456445993031359, 0.1502329192546584], 'DSC09219.JPG': [0.5039198606271778, 0.34782608695652173, 0.05966898954703833, 0.26125776397515527], 'DSC09220.JPG': [0.5644599303135889, 0.6494565217391305, 0.35997386759581884, 0.17585403726708074], 'DSC09221.JPG': [0.3623693379790941, 0.5679347826086957, 0.4318379790940767, 0.18866459627329193], 'DSC09222.JPG': [0.5853658536585366, 0.7216614906832298, 0.30705574912891986, 0.19409937888198758], 'DSC09223.JPG': [0.5446428571428571, 0.687111801242236, 0.2643728222996516, 0.23020186335403728], 'DSC09224.JPG': [0.6302264808362369, 0.3951863354037267, 0.07251742160278746, 0.25271739130434784], 'DSC09225.JPG': [0.2815766550522648, 0.6983695652173914, 0.4453397212543554, 0.1579968944099379], 'DSC09226.JPG': [0.2417247386759582, 0.6933229813664596, 0.3856707317073171, 0.12305900621118013], 'DSC09227.JPG': [0.30248257839721254, 0.5978260869565217, 0.3327526132404181, 0.2263198757763975], 'DSC09228.JPG': [0.4305313588850174, 0.7010869565217391, 0.17138501742160278, 0.21622670807453417], 'DSC09229.JPG': [0.28244773519163763, 0.7166149068322981, 0.27961672473867594, 0.16809006211180125], 'DSC09230.JPG': [0.29464285714285715, 0.4010093167701863, 0.08536585365853659, 0.25232919254658387], 'DSC09231.JPG': [0.33318815331010454, 0.6700310559006211, 0.36890243902439024, 0.17080745341614906], 'DSC09232.JPG': [0.2519599303135889, 0.672360248447205, 0.43423344947735193, 0.20846273291925466], 'DSC09233.JPG': [0.3787020905923345, 0.750388198757764, 0.2530487804878049, 0.15916149068322982], 'DSC09234.JPG': [0.21994773519163763, 0.41847826086956524, 0.09516550522648083, 0.26048136645962733], 'DSC09235.JPG': [0.4327090592334495, 0.7084627329192547, 0.2811411149825784, 0.1968167701863354], 'DSC09236.JPG': [0.35714285714285715, 0.7010869565217391, 0.2702526132404181, 0.16032608695652173], 'DSC09237.JPG': [0.3251306620209059, 0.6972049689440993, 0.3290505226480836, 0.17313664596273293], 'DSC09238.JPG': [0.32665505226480834, 0.71777950310559, 0.19337979094076654, 0.2138975155279503], 'DSC09239.JPG': [0.23214285714285715, 0.46156832298136646, 0.07273519163763066, 0.2822204968944099], 'DSC09240.JPG': [0.6548344947735192, 0.34627329192546585, 0.06533101045296168, 0.3105590062111801], 'DSC09241.JPG': [0.35431184668989546, 0.7166149068322981, 0.18009581881533102, 0.19798136645962733], 'DSC09242.JPG': [0.2663327526132404, 0.5690993788819876, 0.10736062717770035, 0.19914596273291926], 'DSC09243.JPG': [0.28614982578397213, 0.45108695652173914, 0.0703397212543554, 0.21972049689440995], 'DSC09244.JPG': [0.4137630662020906, 0.7569875776397516, 0.18249128919860627, 0.17468944099378883], 'DSC09245.JPG': [0.29115853658536583, 0.34316770186335405, 0.06162891986062718, 0.1952639751552795], 'DSC09246.JPG': [0.3229529616724739, 0.33229813664596275, 0.045949477351916374, 0.25892857142857145], 'DSC09247.JPG': [0.22517421602787457, 0.8047360248447205, 0.1922909407665505, 0.14751552795031056], 'DSC09248.JPG': [0.16702961672473868, 0.4902950310559006, 0.07970383275261324, 0.17468944099378883], 'DSC09249.JPG': [0.29181184668989546, 0.5574534161490683, 0.08493031358885017, 0.15489130434782608], 'DSC09250.JPG': [0.25174216027874563, 0.530667701863354, 0.09494773519163763, 0.19487577639751552], 'DSC09251.JPG': [0.34843205574912894, 0.71777950310559, 0.17073170731707318, 0.11141304347826086], 'DSC09252.JPG': [0.4174651567944251, 0.5702639751552795, 0.12717770034843207, 0.11374223602484472], 'DSC09253.JPG': [0.24542682926829268, 0.46816770186335405, 0.36607142857142855, 0.10753105590062112], 'DSC09254.JPG': [0.2850609756097561, 0.8159937888198758, 0.3595383275261324, 0.10209627329192547], 'DSC09255.JPG': [0.4292247386759582, 0.578027950310559, 0.14960801393728224, 0.1529503105590062], 'DSC09256.JPG': [0.38022648083623695, 0.6902173913043478, 0.09538327526132404, 0.1063664596273292]
    
}


# In[ ]:





# In[ ]:





# In[ ]:





# In[33]:


num=0


# In[34]:



def plot_images2( images_list ):
    global num
    import math
    num_cols = 5
    num_rows = math.ceil( len(images_list) / num_cols )
    figsize = (10,10)
    fig = plt.figure()
    for i in range (0, len(images_list) ):
        info = images_list[i]
        x1, y1, x2, y2 = info[1]       
        image = draw_boundingbox( info[0], (x1, y1), (x2, y2) )      
        axi = fig.add_subplot(num_rows, num_cols, i+1)
        #axi.axis( 'off' )
        axi.set_title( ("%.1f" % info[2] ) )
        image = image[:,:,[2,1,0]]
        cv2.imwrite("C:\\Users\\v-jelin\\Pictures\\overflowTest\\"+ "overflow" + str(num+1) + ".JPG", info[0][:,:,[2,1,0]])       
        print(num+1)
        print("資料擴增後的像素位置"+str(info[1]))
        #plt.imshow(image)
        #plt.show()f
        dot_image_regions2["overflow"+str(num+1) + ".JPG"] = [x1/4592, y1/2576, (x2-x1)/4592, (y2-y1)/2576]  
        num = num + 1
        print("新增的dict圖片和標準化座標"+str(dot_image_regions2))


# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# # 流餡資料

# In[35]:


original_boundingbox2 = []
xmlDirPath2 = 'C:\\Users\\v-jelin\\Pictures\\overflowLabel\\'
files2= os.listdir(xmlDirPath2)
for filename in files2: #遍歷資料夾   
    original_boundingbox2.append(parse_xml(xmlDirPath2+ filename))#取得所有xml檔裡面的xywh  


# In[36]:


imageDirPath2="C:\\Users\\v-jelin\\Pictures\\overflow\\"
imgfiles2= os.listdir(imageDirPath2)

for i in range(len(original_boundingbox2)):    
    original_boundingbox2[i] = list(map(int, original_boundingbox2[i])) #str list to int list
    for j in range(len(imgfiles2)):
        if(i == j):
            img = cv2.imread(imageDirPath2 + imgfiles2[j])
            img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB) 
            
            rotated_images = apply_transformation( img, original_boundingbox2[i], "rotation", 10 )
            plot_images2(rotated_images)

            w_shifted_images = apply_transformation( img, original_boundingbox2[i], "width_shift", 10 )
            plot_images2(w_shifted_images)

#             h_shifted_images = apply_transformation( img, original_boundingbox2[i], "height_shift", 6 )
#             plot_images2(h_shifted_images)


# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:





# In[ ]:


#overflow_tag = trainer.create_tag(project.id, "流餡")


# In[ ]:





# In[ ]:





# In[37]:


base_image_url = "C:\\Users\\v-jelin\\Pictures\\overflowTest\\"

# Go through the data table above and create the images
print ("Adding images...")
tagged_images_with_regions2 = []
total = 0
for file_name in dot_image_regions2.keys():
    
    x,y,w,h = dot_image_regions2[file_name]
    regions = [ Region(tag_id=overflow_tag.id, left=x,top=y,width=w,height=h) ]

    with open(base_image_url + file_name, mode="rb") as image_contents:
        tagged_images_with_regions2.append(ImageFileCreateEntry(name=file_name, contents=image_contents.read(), regions=regions))

    total = total+1
    print(total)
    if(total == 30):
        upload_result = trainer.create_images_from_files('bd61cc61-b58a-4011-8da8-85fd909bcd22', images=tagged_images_with_regions2)
        #upload_result = trainer.create_images_from_files(project.id, images=tagged_images_with_regions)
        if not upload_result.is_batch_successful:
            print("Image batch upload failed.")
            for image in upload_result.images:
                print("Image status: ", image.status)
            exit(-1)
        tagged_images_with_regions2=[]
        total = 0       
        print ("OK...")
       
       
#upload_result = trainer.create_images_from_files(project.id, images=tagged_images_with_regions2)
        
        



# In[ ]:




